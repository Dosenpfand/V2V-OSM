dist: trusty
sudo: required
language: python
python:
  - "3.4"
  - "3.6"
# SUMO ppa can not be added with the apt addon because it is not whitelisted
before_install:
  - sudo add-apt-repository ppa:sumo/stable -y
  - sudo apt-get update -q
  - sudo apt-get install sumo
install:
  - pip install --upgrade pip
  - pip install -r requirements.txt
  - pip install -r requirements-test.txt
  # Clone SUMO to get newer tools than in the repository
  - git clone --depth 1 https://github.com/planetsumo/sumo.git $TRAVIS_BUILD_DIR/sumo
addons:
  apt:
    packages:
    - libgdal1h
    - gdal-bin
    - libgdal-dev
    - libspatialindex-dev
    - libgeos-dev
    - libopenblas-dev
    - liblapack-dev
    - gfortran
    - sumo
cache: pip
branches:
  except:
  - travis
  - dev
script:
  - nosetests --with-coverage --cover-html --cover-tests --cover-package=vtovosm
after_success:
  - coverage-badge -f -o .travis/coverage.svg
  - if [[ $TRAVIS_PYTHON_VERSION == 3.4 ]]; then .travis/push.sh; fi

# TODO: also test packaging!
